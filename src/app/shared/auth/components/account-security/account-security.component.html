
    <div class="account-security">
      <!-- Sign-in Methods -->
      <div class="security-section">
        <h3 class="section-title">Sign-in Method</h3>
        <div class="signin-methods">

          <!-- OAuth consignors -->
          <div *ngFor="let consignor of securityData()?.linkedconsignors" class="signin-method">
            <div class="method-info">
              <span class="method-icon" [class]="'icon-' + consignor.id">{{ getProviderIcon(consignor.id) }}</span>
              <div class="method-details">
                <span class="method-name">{{ consignor.name }}</span>
                <span class="method-email" *ngIf="consignor.email">{{ consignor.email }}</span>
                <span class="method-status" *ngIf="!consignor.email">Not connected</span>
              </div>
            </div>
            <div class="method-actions">
              <span *ngIf="consignor.connected" class="status-connected">‚úì Connected</span>
              <button
                *ngIf="consignor.connected"
                class="btn-disconnect"
                (click)="disconnectProvider(consignor.id)"
                [disabled]="isLoading()">
                Disconnect
              </button>
              <button
                *ngIf="!consignor.connected"
                class="btn-connect"
                (click)="connectProvider(consignor.id)"
                [disabled]="isLoading()">
                Connect
              </button>
            </div>
          </div>

          <!-- Email/Password -->
          <div class="signin-method" *ngIf="securityData()?.hasEmailPassword">
            <div class="method-info">
              <span class="method-icon icon-email">‚úâÔ∏è</span>
              <div class="method-details">
                <span class="method-name">Email/Password</span>
                <span class="method-email" *ngIf="securityData()?.email">{{ securityData()?.email }}</span>
              </div>
            </div>
            <div class="method-actions">
              <button
                class="btn-change-password"
                (click)="changePassword()"
                [disabled]="isLoading()">
                Change Password
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Two-Factor Authentication -->
      <div class="security-section" *ngIf="show2FA">
        <h3 class="section-title">Two-Factor Authentication</h3>
        <div class="twofa-container">
          <div *ngIf="!securityData()?.twoFactorAuth.enabled" class="twofa-disabled">
            <div class="twofa-icon">üîí</div>
            <div class="twofa-content">
              <h4>2FA is not enabled</h4>
              <p>Add extra security by requiring a code from your authenticator app when you sign in.</p>
              <button
                class="btn-primary"
                (click)="enable2FA()"
                [disabled]="isLoading()">
                {{ isLoading() ? 'Setting up...' : 'Enable 2FA' }}
              </button>
            </div>
          </div>

          <div *ngIf="securityData()?.twoFactorAuth.enabled" class="twofa-enabled">
            <div class="twofa-status">
              <span class="status-enabled">‚úÖ 2FA is enabled</span>
              <span class="setup-date" *ngIf="securityData()?.twoFactorAuth.setupAt">
                Since {{ securityData()?.twoFactorAuth.setupAt | date:'mediumDate' }}
              </span>
            </div>
            <div class="twofa-actions">
              <button
                class="btn-secondary"
                (click)="manageTwoFA()"
                [disabled]="isLoading()">
                Manage 2FA
              </button>
              <button
                class="btn-danger"
                (click)="disable2FA()"
                [disabled]="isLoading()">
                Disable 2FA
              </button>
            </div>
            <div class="backup-codes" *ngIf="securityData()?.twoFactorAuth.backupCodes">
              <span class="backup-info">{{ securityData()?.twoFactorAuth.backupCodes }} backup codes remaining</span>
              <button class="btn-link" (click)="viewBackupCodes()">View codes</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Active Sessions -->
      <div class="security-section" *ngIf="showActiveSessions">
        <h3 class="section-title">Active Sessions</h3>
        <div class="sessions-container">
          <div *ngFor="let session of securityData()?.activeSessions" class="session-item">
            <div class="session-info">
              <div class="session-device">{{ session.device }}</div>
              <div class="session-details">
                <span class="session-location">{{ session.location }}</span>
                <span class="session-separator">‚Ä¢</span>
                <span class="session-time">{{ getSessionTimeText(session.lastActivity) }}</span>
              </div>
            </div>
            <div class="session-actions">
              <span *ngIf="session.isCurrent" class="current-session">Current</span>
              <button
                *ngIf="!session.isCurrent"
                class="btn-revoke"
                (click)="revokeSession(session.id)"
                [disabled]="isLoading()">
                Revoke
              </button>
            </div>
          </div>

          <div class="bulk-actions" *ngIf="hasOtherSessions()">
            <button
              class="btn-danger-outline"
              (click)="signOutAllOther()"
              [disabled]="isLoading()">
              Sign out all other sessions
            </button>
          </div>
        </div>
      </div>

      <!-- Messages -->
      <div class="messages" *ngIf="successMessage() || errorMessage()">
        <div *ngIf="successMessage()" class="message success">{{ successMessage() }}</div>
        <div *ngIf="errorMessage()" class="message error">{{ errorMessage() }}</div>
      </div>
    </div>
  