
    <div class="modal-backdrop" (click)="onBackdropClick($event)" *ngIf="isVisible">
      <div class="welcome-modal" (click)="$event.stopPropagation()">
        <!-- Header -->
        <div class="modal-header">
          <button class="close-btn" (click)="closeModal()" aria-label="Close modal">
            <span aria-hidden="true">×</span>
          </button>
          <h2 class="modal-title">{{ welcomeMessage.title }}</h2>
          <p class="modal-subtitle">{{ welcomeMessage.subtitle }}</p>

          <!-- Progress Bar -->
          <div class="progress-section" *ngIf="progress">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="progress.progressPercentage"></div>
            </div>
            <p class="progress-text">
              {{ progress.completedSteps }} of {{ progress.totalSteps }} completed
              <span class="progress-percentage">({{ progress.progressPercentage }}%)</span>
            </p>
          </div>
        </div>

        <!-- Steps List -->
        <div class="modal-body">
          <div class="steps-list">
            <div
              *ngFor="let step of steps; trackBy: trackByStepId"
              class="step-item"
              [class.completed]="step.completed"
              [class.next-step]="!step.completed && isNextStep(step)">

              <!-- Icon and Status -->
              <div class="step-icon-container">
                <div class="step-icon" *ngIf="!step.completed">{{ step.icon }}</div>
                <div class="step-check" *ngIf="step.completed">✅</div>
              </div>

              <!-- Content -->
              <div class="step-content">
                <h3 class="step-title">{{ step.title }}</h3>
                <p class="step-description">{{ step.description }}</p>
              </div>

              <!-- Action Button -->
              <div class="step-action">
                <a
                  *ngIf="!step.completed"
                  [routerLink]="step.routerLink"
                  class="step-button primary"
                  (click)="onStepClick(step)">
                  {{ step.actionText }}
                </a>
                <div
                  *ngIf="step.completed"
                  class="step-completed">
                  ✓ Done
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer -->
        <div class="modal-footer">
          <div class="footer-center">
            <button
              class="btn-dismiss"
              (click)="dismissOrClose()"
              [disabled]="isDismissing()">
              {{ isDismissing() ? 'Saving...' : (isManualOpen ? 'Close' : 'No thanks, I can find my own way') }}
            </button>
          </div>
        </div>

        <!-- Loading Overlay -->
        <div class="loading-overlay" *ngIf="isDismissing()">
          <div class="loading-spinner"></div>
        </div>
      </div>
    </div>
  