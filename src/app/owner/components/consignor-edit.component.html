
    <div class="consignor-edit-container">
      <div class="edit-header">
        <div class="breadcrumb">
          <a [routerLink]="['/owner/consignors', providerId()]">‚Üê Back to consignor</a>
        </div>
        <h1>Edit consignor</h1>
      </div>

      <div class="edit-card" *ngIf="!isProviderLoading(); else loading">
        <form (ngSubmit)="onSubmit()" #providerForm="ngForm">
          <div class="form-section">
            <h3>Basic Information</h3>
            <div class="form-row">
              <div class="form-group">
                <label for="name">consignor Name *</label>
                <input
                  type="text"
                  id="name"
                  name="name"
                  [(ngModel)]="editData.name"
                  required
                  #nameField="ngModel"
                  class="form-control"
                  [class.error]="nameField.invalid && nameField.touched"
                  placeholder="Enter consignor name"
                >
                <div class="error-message" *ngIf="nameField.invalid && nameField.touched">
                  consignor name is required
                </div>
              </div>

              <div class="form-group">
                <label for="email">Email Address *</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  [(ngModel)]="editData.email"
                  required
                  email
                  #emailField="ngModel"
                  class="form-control"
                  [class.error]="emailField.invalid && emailField.touched"
                  placeholder="Enter email address"
                >
                <div class="error-message" *ngIf="emailField.invalid && emailField.touched">
                  <span *ngIf="emailField.errors?.['required']">Email is required</span>
                  <span *ngIf="emailField.errors?.['email']">Please enter a valid email</span>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="phone">Phone Number</label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  [(ngModel)]="editData.phone"
                  class="form-control"
                  placeholder="(555) 123-4567"
                >
              </div>

              <div class="form-group">
                <label for="address">Address</label>
                <input
                  type="text"
                  id="address"
                  name="address"
                  [(ngModel)]="editData.address"
                  class="form-control"
                  placeholder="Enter address"
                >
              </div>
            </div>
          </div>

          <div class="form-section">
            <h3>Business Settings</h3>
            <div class="form-row">
              <div class="form-group">
                <label for="commissionRate">Commission Rate (%) *</label>

                <!-- Use Default Checkbox -->
                <div class="checkbox-wrapper" style="margin-bottom: 0.5rem;">
                  <label class="checkbox-label">
                    <input
                      type="checkbox"
                      [(ngModel)]="useDefaultCommissionRate"
                      (ngModelChange)="onUseDefaultCommissionChange()"
                      name="useDefaultCommissionRate"
                    >
                    Use shop default rate ({{ defaultCommissionRate }}%)
                  </label>
                </div>

                <input
                  type="number"
                  id="commissionRate"
                  name="commissionRate"
                  [(ngModel)]="editData.commissionRate"
                  required
                  min="0"
                  max="100"
                  step="0.1"
                  #commissionField="ngModel"
                  class="form-control"
                  [class.error]="commissionField.invalid && commissionField.touched"
                  [readonly]="useDefaultCommissionRate"
                  [class.readonly]="useDefaultCommissionRate"
                  placeholder="50.0"
                >

                <!-- Commission Rate Hint -->
                <small class="form-text commission-hint" [class.override]="isUsingCustomCommissionRate()">
                  {{ getCommissionRateHint() }}
                </small>

                <div class="error-message" *ngIf="commissionField.invalid && commissionField.touched">
                  <span *ngIf="commissionField.errors?.['required']">Commission rate is required</span>
                  <span *ngIf="commissionField.errors?.['min']">Rate must be 0 or higher</span>
                  <span *ngIf="commissionField.errors?.['max']">Rate must be 100 or lower</span>
                </div>
              </div>

              <div class="form-group">
                <label for="preferredPaymentMethod">Preferred Payment Method</label>
                <select
                  id="preferredPaymentMethod"
                  name="preferredPaymentMethod"
                  [(ngModel)]="editData.preferredPaymentMethod"
                  class="form-control"
                >
                  <option value="">Select payment method</option>
                  <option value="Check">Check</option>
                  <option value="Bank Transfer">Bank Transfer</option>
                  <option value="PayPal">PayPal</option>
                  <option value="Cash">Cash</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label for="paymentDetails">Payment Details</label>
              <textarea
                id="paymentDetails"
                name="paymentDetails"
                [(ngModel)]="editData.paymentDetails"
                class="form-control"
                rows="3"
                placeholder="Enter payment details (e.g., PayPal email, bank account info, mailing address)"
              ></textarea>
              <small class="form-text">This information is used for processing payouts</small>
            </div>
          </div>

          <div class="form-section">
            <h3>Additional Information</h3>
            <div class="form-group">
              <label for="notes">Notes</label>
              <textarea
                id="notes"
                name="notes"
                [(ngModel)]="editData.notes"
                class="form-control"
                rows="4"
                placeholder="Add any additional notes about this consignor..."
              ></textarea>
            </div>

            <div class="form-group">
              <label for="status">Consignor Status</label>
              <select
                id="status"
                name="status"
                [(ngModel)]="editData.status"
                class="form-control"
              >
                <option *ngFor="let option of statusOptions" [value]="option.value">
                  {{ option.label }}
                </option>
              </select>
              <small class="form-text">{{ getStatusDescription() }}</small>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" [routerLink]="['/owner/consignors', providerId()]">
              Cancel
            </button>
            <button
              type="submit"
              class="btn-primary"
              [disabled]="providerForm.invalid || isSubmitting()"
            >
              {{ isSubmitting() ? 'Saving...' : 'Save Changes' }}
            </button>
          </div>

          <div class="success-message" *ngIf="successMessage()">
            {{ successMessage() }}
          </div>

          <div class="error-message" *ngIf="errorMessage()">
            {{ errorMessage() }}
          </div>
        </form>
      </div>

      <ng-template #loading>
        <div class="loading">Loading consignor...</div>
      </ng-template>
    </div>
  