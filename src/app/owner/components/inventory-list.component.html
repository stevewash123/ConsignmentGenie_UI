<div class="inventory-page">
    <!-- Page Header -->
    <div class="page-header">
      <div class="header-content">
        <h1>Inventory Management</h1>
        <p class="header-subtitle" *ngIf="!isSquareInventoryMode()">View and manage all inventory items</p>
        <p class="header-subtitle" *ngIf="isSquareInventoryMode()">Viewing inventory from Square</p>
      </div>
      <div class="header-actions">
        <button *ngIf="isSquareInventoryMode()" class="btn-primary secondary" (click)="refreshInventory()" [disabled]="isLoading()">
          üîÑ {{ isLoading() ? 'Refreshing...' : 'Refresh Square Data' }}
        </button>
        <button *ngIf="!isSquareInventoryMode()" class="btn-primary secondary" (click)="manageCategories()">
          üè∑Ô∏è Manage Categories
        </button>
        <button *ngIf="!isSquareInventoryMode()" class="btn-primary secondary" (click)="openBulkImport()">
          üì§ Bulk Upload
        </button>
        <button *ngIf="!isSquareInventoryMode()" class="btn-primary secondary" (click)="createNewItem()">
          üì¶ Add New Item
        </button>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="tab-bar">
      <div class="tab-buttons">
        <button
          class="tab-btn"
          [class.active]="viewMode() === 'regular'"
          (click)="switchViewMode('regular')">
          üì¶ Regular Inventory
          <span class="tab-count" *ngIf="itemsResult()?.totalCount">({{ itemsResult()!.totalCount }})</span>
        </button>
        <button
          class="tab-btn"
          [class.active]="viewMode() === 'pending'"
          (click)="switchViewMode('pending')"
          *ngIf="isSquareInventoryMode()">
          ‚è≥ Pending Imports
          <span class="tab-count" *ngIf="pendingImportsResult()?.totalCount">({{ pendingImportsResult()!.totalCount }})</span>
        </button>
      </div>
      <div class="tab-bar-actions">
        <button class="btn-primary" (click)="openBulkImport()">
          üì§ Bulk Import
        </button>
      </div>
    </div>

    <!-- Regular Inventory Tab -->
    <div class="tab-content" *ngIf="viewMode() === 'regular'">
      <!-- Controls Row -->
      <div class="controls-bar">
        <div class="search-group">
          <input
            type="text"
            [(ngModel)]="searchQuery"
            (keyup.enter)="applyFilters()"
            placeholder="Search items..."
            class="filter-input search-input">
          <button class="btn-primary secondary" (click)="applyFilters()">Search</button>
        </div>
        <div class="controls-group">
          <button class="btn-primary secondary" (click)="openColorGuideModal()">
            üé® Color Guide
          </button>
          <select [(ngModel)]="pageSize" (change)="changePageSize()" class="filter-select page-size-select">
            <option value="10">10 per page</option>
            <option value="25">25 per page</option>
            <option value="50">50 per page</option>
            <option value="100">100 per page</option>
          </select>
        </div>
      </div>

      <!-- Regular Inventory Table -->
      <div class="table-wrapper" *ngIf="!isInventoryLoading() && itemsResult(); else loadingInventory">
        <table class="data-table">
          <thead>
            <tr class="header-row">
              <th>Image</th>
              <th class="sortable" (click)="setSorting('title')">
                Title / SKU
                <span class="sort-indicator" [class.active]="sortBy === 'title'">
                  {{ sortDirection === 'asc' ? '‚Üë' : '‚Üì' }}
                </span>
              </th>
              <th>
                Category
                <app-column-filter
                  filterType="select"
                  label="Category"
                  [options]="categoryOptions()"
                  [value]="selectedCategory"
                  placeholder="All Categories"
                  (filterChange)="onFilterChange('category', $event)"
                  (filterClear)="onFilterClear('category')">
                </app-column-filter>
              </th>
              <th>
                Status
                <app-column-filter
                  filterType="select"
                  label="Status"
                  [options]="statusOptions"
                  [value]="selectedStatus"
                  placeholder="All"
                  (filterChange)="onFilterChange('status', $event)"
                  (filterClear)="onFilterClear('status')">
                </app-column-filter>
              </th>
              <th class="sortable" (click)="setSorting('price')">
                Price
                <span class="sort-indicator" [class.active]="sortBy === 'price'">
                  {{ sortDirection === 'asc' ? '‚Üë' : '‚Üì' }}
                </span>
              </th>
              <th>
                Condition
                <app-column-filter
                  filterType="select"
                  label="Condition"
                  [options]="conditionOptions"
                  [value]="selectedCondition"
                  placeholder="All"
                  (filterChange)="onFilterChange('condition', $event)"
                  (filterClear)="onFilterClear('condition')">
                </app-column-filter>
              </th>
              <th>
                Consignor
                <app-column-filter
                  filterType="select"
                  label="Consignor"
                  [options]="consignorOptions()"
                  [value]="selectedConsignor"
                  placeholder="All"
                  (filterChange)="onFilterChange('consignor', $event)"
                  (filterClear)="onFilterClear('consignor')">
                </app-column-filter>
              </th>
              <th class="sortable" (click)="setSorting('receivedDate')">
                Received
                <span class="sort-indicator" [class.active]="sortBy === 'receivedDate'">
                  {{ sortDirection === 'asc' ? '‚Üë' : '‚Üì' }}
                </span>
              </th>
              <th>
                Expires
                <app-column-filter
                  filterType="select"
                  label="Expiration"
                  [options]="expirationOptions"
                  [value]="selectedExpiration"
                  placeholder="All"
                  (filterChange)="onFilterChange('expiration', $event)"
                  (filterClear)="onFilterClear('expiration')">
                </app-column-filter>
              </th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for (item of itemsResult()?.items; track item.itemId) {
              <tr>
                <td class="image-cell">
                  @if (item.primaryImageUrl) {
                    <div class="image-container has-image" [title]="'Preview image for ' + item.title">
                      <img [src]="item.primaryImageUrl" [alt]="item.title" class="item-thumbnail"
                           (mouseenter)="showImagePreview($event, item.primaryImageUrl)" (mouseleave)="hideImagePreview()">
                    </div>
                  } @else {
                    <div class="no-image">üì∑</div>
                  }
                </td>
                <td>
                  <div class="cell-primary">{{ item.title }}</div>
                  <div class="cell-secondary">{{ item.sku }}</div>
                </td>
                <td>{{ item.category || '‚Äî' }}</td>
                <td>
                  <span class="badge" [ngClass]="{
                    'badge-success': item.status === 'Available',
                    'badge-info': item.status === 'Sold',
                    'badge-neutral': item.status === 'Removed'
                  }">{{ item.status }}</span>
                </td>
                <td class="cell-money">
                  <div class="price-suggested">${{ item.price | number:'1.2-2' }}</div>
                  <div class="price-minimum" *ngIf="item.minimumPrice">(Min: ${{ item.minimumPrice | number:'1.2-2' }})</div>
                </td>
                <td>
                  <span class="badge" [ngClass]="{
                    'badge-success': item.condition === 'New',
                    'badge-info': item.condition === 'LikeNew',
                    'badge-neutral': item.condition === 'Good',
                    'badge-warn': item.condition === 'Fair',
                    'badge-error': item.condition === 'Poor'
                  }">{{ getConditionLabel(item.condition) }}</span>
                </td>
                <td>
                  <span class="consignor-link" 
                        [class.clickable]="item.consignorId"
                        (click)="item.consignorId && viewConsignor(item.consignorId)">
                    {{ item.consignorName || 'Unassigned' }}
                  </span>
                </td>
                <td>{{ item.receivedDate | date:'MMM d, y' }}</td>
                <td [ngClass]="{
                  'expiration-expired': getExpirationStatusClass(item.expirationDate) === 'expiration-expired',
                  'expiration-warning': getExpirationStatusClass(item.expirationDate) === 'expiration-warning'
                }">
                  {{ getExpirationDisplayText(item.expirationDate) }}
                </td>
                <td>
                  <button class="btn-icon" (click)="viewItem(item.itemId)" title="View Details">üëÅÔ∏è</button>
                  <button class="btn-icon" (click)="editItem(item)" title="Edit">‚úèÔ∏è</button>
                  <button class="btn-icon danger" *ngIf="item.status === 'Available'" (click)="removeFromInventory(item)" title="Remove">üì§</button>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="pagination" *ngIf="itemsResult() && itemsResult()!.totalPages > 1">
        <button class="page-btn" [disabled]="currentPage() === 1" (click)="goToPage(currentPage() - 1)">Previous</button>
        <div class="page-numbers">
          @for (page of getPageNumbers(); track page) {
            <button class="page-btn" [class.active]="page === currentPage()" (click)="goToPage(page)">{{ page }}</button>
          }
        </div>
        <button class="page-btn" [disabled]="currentPage() === itemsResult()?.totalPages" (click)="goToPage(currentPage() + 1)">Next</button>
      </div>
    </div>

    <!-- Pending Imports Tab -->
    <div class="tab-content" *ngIf="viewMode() === 'pending'">
      <!-- Controls Row -->
      <div class="controls-bar">
        <div class="search-group">
          <input
            type="text"
            [(ngModel)]="searchQuery"
            (keyup.enter)="applyFilters()"
            placeholder="Search pending imports..."
            class="filter-input search-input">
          <button class="btn-primary secondary" (click)="applyFilters()">Search</button>
        </div>
        <div class="controls-group">
          <button
            class="btn-primary secondary"
            [disabled]="selectedPendingImports().size === 0"
            (click)="openBulkAssignModal()">
            üë§ Assign Selected ({{ selectedPendingImports().size }})
          </button>
          <button
            class="btn-primary"
            [disabled]="verifiedPendingImports().size === 0 || isLoading()"
            (click)="submitVerifiedItems()">
            {{ isLoading() ? 'Importing...' : '‚úì Import Verified (' + verifiedPendingImports().size + ')' }}
          </button>
          <select [(ngModel)]="pageSize" (change)="changePageSize()" class="filter-select page-size-select">
            <option value="10">10 per page</option>
            <option value="25">25 per page</option>
            <option value="50">50 per page</option>
            <option value="100">100 per page</option>
          </select>
        </div>
      </div>

      <!-- Pending Imports Table -->
      <div class="table-wrapper" *ngIf="!isInventoryLoading() && pendingImportsResult(); else loadingPending">
        <table class="data-table">
          <thead>
            <tr class="header-row">
              <th class="checkbox-col">
                <div class="checkbox-header">
                  <input type="checkbox" [checked]="allPendingVerified()" (change)="toggleAllVerification($event)" class="checkbox-input" title="Verify all">
                  <span class="checkbox-label-text">Verified</span>
                </div>
              </th>
              <th class="checkbox-col">
                <div class="checkbox-header">
                  <input type="checkbox" [checked]="allPendingSelected()" (change)="toggleSelectAll()" class="checkbox-input" title="Select all">
                  <span class="checkbox-label-text">Select</span>
                </div>
              </th>
              <th>Image</th>
              <th>Item</th>
              <th>Price</th>
              <th>SKU</th>
              <th>
                Category
                <app-column-filter
                  filterType="select"
                  label="Category"
                  [options]="categoryOptions()"
                  [value]="selectedCategory"
                  placeholder="All"
                  (filterChange)="onFilterChange('category', $event)"
                  (filterClear)="onFilterClear('category')">
                </app-column-filter>
              </th>
              <th>
                Condition
                <app-column-filter
                  filterType="select"
                  label="Condition"
                  [options]="conditionOptions"
                  [value]="selectedCondition"
                  placeholder="All"
                  (filterChange)="onFilterChange('condition', $event)"
                  (filterClear)="onFilterClear('condition')">
                </app-column-filter>
              </th>
              <th>
                Consignor
                <app-column-filter
                  filterType="select"
                  label="Consignor"
                  [options]="consignorOptions()"
                  [value]="selectedConsignor"
                  placeholder="All"
                  (filterChange)="onFilterChange('consignor', $event)"
                  (filterClear)="onFilterClear('consignor')">
                </app-column-filter>
              </th>
              <th>
                Source
                <app-column-filter
                  filterType="select"
                  label="Source"
                  [options]="sourceOptions"
                  [value]="selectedSource"
                  placeholder="All"
                  (filterChange)="onFilterChange('source', $event)"
                  (filterClear)="onFilterClear('source')">
                </app-column-filter>
              </th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for (item of pendingImportsResult()?.items; track item.id) {
              <tr>
                <td class="checkbox-col">
                  <input
                    type="checkbox"
                    [checked]="verifiedPendingImports().has(item.id)"
                    [disabled]="!item.consignorId"
                    (change)="toggleItemVerification(item.id, $event)"
                    class="checkbox-input">
                </td>
                <td class="checkbox-col">
                  <input
                    type="checkbox"
                    [checked]="selectedPendingImports().has(item.id)"
                    [disabled]="!!getAssignedConsignorName(item.id)"
                    (change)="toggleSelectItem(item.id)"
                    class="checkbox-input">
                </td>
                <td class="image-cell">
                  @if (item.imageUrl) {
                    <div class="image-container" [title]="'Preview image for ' + item.name">
                      <span class="binoculars-icon" (mouseenter)="showImagePreview($event, item.imageUrl)" (mouseleave)="hideImagePreview()">üîç</span>
                    </div>
                  } @else {
                    <div class="no-image">üì∑</div>
                  }
                </td>
                <td>
                  <div class="cell-primary">{{ item.name }}</div>
                  <div class="cell-secondary" *ngIf="item.brand">{{ item.brand }}</div>
                  <div class="cell-secondary" *ngIf="item.description">{{ item.description }}</div>
                </td>
                <td class="cell-money" [class.dirty]="hasUnsavedEdits(item.id)">
                  <input
                    type="number"
                    step="0.01"
                    min="0"
                    [value]="getDisplayValue(item, 'price')"
                    (input)="onPriceEdit(item.id, $event)"
                    class="inline-edit-input price-input"
                    [attr.data-cy]="'price-input-' + item.id">
                  <div class="price-context">
                    @if (item.minimumPrice) {
                      <div class="price-minimum">Floor: ${{ item.minimumPrice | number:'1.2-2' }}</div>
                      @if (isPriceBelowFloor(item)) {
                        <div class="floor-warning" [attr.data-cy]="'floor-warning-' + item.id">‚ö†Ô∏è Below floor</div>
                      }
                    } @else {
                      <div class="price-minimum">No minimum</div>
                    }
                  </div>
                </td>
                <td class="cell-secondary">{{ item.sku || '‚Äî' }}</td>
                <td [class.dirty]="hasUnsavedEdits(item.id)">
                  <select
                    [value]="getDisplayValue(item, 'category')"
                    (change)="onCategoryEdit(item.id, $event)"
                    class="inline-edit-select"
                    [attr.data-cy]="'category-select-' + item.id">
                    <option value="">Select category...</option>
                    @for (category of categories(); track category.id) {
                      <option [value]="category.name">{{ category.name }}</option>
                    }
                  </select>
                </td>
                <td [class.dirty]="hasUnsavedEdits(item.id)">
                  <select
                    [value]="getDisplayValue(item, 'condition')"
                    (change)="onConditionEdit(item.id, $event)"
                    class="inline-edit-select"
                    [attr.data-cy]="'condition-select-' + item.id">
                    <option value="">Select condition...</option>
                    <option value="New">New</option>
                    <option value="LikeNew">Like New</option>
                    <option value="Good">Good</option>
                    <option value="Fair">Fair</option>
                    <option value="Poor">Poor</option>
                  </select>
                </td>
                <td>
                  @if (item.consignorName) {
                    <span class="badge badge-success">{{ item.consignorName }}</span>
                  } @else {
                    <span class="badge badge-warn">Needs Assignment</span>
                  }
                </td>
                <td>
                  <span class="badge" [ngClass]="{
                    'badge-info': item.source === 'Square',
                    'badge-neutral': item.source === 'CSV',
                    'badge-warn': item.source === 'Manifest'
                  }">{{ item.source || 'Unknown' }}</span>
                </td>
                <td>
                  @if (assignmentDropdownOpen() === item.id) {
                    <div class="inline-assign">
                      <select
                        [value]="getIndividualConsignorSelection(item.id)"
                        (change)="onConsignorSelectionChange(item.id, $event)"
                        class="filter-select">
                        <option value="">Select...</option>
                        @for (consignor of consignors(); track consignor.id) {
                          <option [value]="consignor.id">{{ consignor.name }}</option>
                        }
                      </select>
                      <button class="btn-icon" [disabled]="!getIndividualConsignorSelection(item.id)" (click)="confirmIndividualAssignment(item.id)" title="Confirm">‚úì</button>
                      <button class="btn-icon" (click)="cancelIndividualAssignment(item.id)" title="Cancel">‚úï</button>
                    </div>
                  } @else {
                    <button class="btn-icon" [disabled]="selectedPendingImports().size > 1" (click)="toggleAssignmentDropdown(item.id)" title="Assign Consignor">üë§</button>
                    <button class="btn-icon danger" (click)="deletePendingItem(item.id)" title="Reject">üóëÔ∏è</button>
                  }
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="pagination" *ngIf="pendingImportsResult() && pendingImportsResult()!.totalPages > 1">
        <button class="page-btn" [disabled]="currentPage() === 1" (click)="goToPage(currentPage() - 1)">Previous</button>
        <div class="page-numbers">
          @for (page of getPageNumbers(); track page) {
            <button class="page-btn" [class.active]="page === currentPage()" (click)="goToPage(page)">{{ page }}</button>
          }
        </div>
        <button class="page-btn" [disabled]="currentPage() === pendingImportsResult()?.totalPages" (click)="goToPage(currentPage() + 1)">Next</button>
      </div>
    </div>

    <!-- Loading States -->
    <ng-template #loadingInventory>
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p>Loading inventory...</p>
      </div>
    </ng-template>

    <ng-template #loadingPending>
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p>Loading pending imports...</p>
      </div>
    </ng-template>

    <!-- Empty States -->
    <div class="empty-state" *ngIf="!isInventoryLoading() && viewMode() === 'regular' && itemsResult()?.items.length === 0">
      <div class="empty-icon">üì¶</div>
      <h3>No inventory items found</h3>
      <p>Try adjusting your search or filters, or add new items to your inventory.</p>
    </div>

    <div class="empty-state" *ngIf="!isInventoryLoading() && viewMode() === 'pending' && pendingImportsResult()?.items.length === 0">
      <div class="empty-icon">‚è≥</div>
      <h3>No pending imports found</h3>
      <p>Import items from Square or upload via CSV to see them here.</p>
    </div>

    <!-- Error State -->
    <div class="error-state" *ngIf="error()">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h3>Something went wrong</h3>
      <p>{{ error() }}</p>
      <button class="btn-primary" (click)="loadItems()">Try Again</button>
    </div>

    <!-- Color Guide Modal -->
    <div class="modal-overlay" *ngIf="isColorGuideModalOpen()" (click)="closeColorGuideModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>Status & Condition Color Guide</h2>
          <button class="close-btn" (click)="closeColorGuideModal()">√ó</button>
        </div>
        <div class="modal-body">
          <div class="guide-section">
            <h4>Status Colors</h4>
            <div class="guide-items">
              <div class="guide-item"><span class="badge badge-success">Available</span> Available for sale</div>
              <div class="guide-item"><span class="badge badge-info">Sold</span> Successfully sold</div>
              <div class="guide-item"><span class="badge badge-neutral">Removed</span> Removed from inventory</div>
            </div>
          </div>
          <div class="guide-section">
            <h4>Condition Colors</h4>
            <div class="guide-items">
              <div class="guide-item"><span class="badge badge-success">New</span> Brand new, tags attached</div>
              <div class="guide-item"><span class="badge badge-info">Like New</span> Excellent condition</div>
              <div class="guide-item"><span class="badge badge-neutral">Good</span> Normal wear</div>
              <div class="guide-item"><span class="badge badge-warn">Fair</span> Visible wear</div>
              <div class="guide-item"><span class="badge badge-error">Poor</span> Significant wear</div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" (click)="closeColorGuideModal()">Close</button>
        </div>
      </div>
    </div>

    <!-- Bulk Assign Modal -->
    <div class="modal-overlay" *ngIf="isBulkAssignModalOpen()" (click)="closeBulkAssignModal()">
      <div class="modal-content modal-sm" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>üë§ Assign to Consignor</h2>
          <button class="close-btn" (click)="closeBulkAssignModal()">√ó</button>
        </div>
        <div class="modal-body">
          <p class="assign-count">Assigning {{ selectedPendingImports().size }} selected item(s)</p>

          <div class="form-group">
            <label for="assignConsignor">Consignor <span class="required">*</span></label>
            <select id="assignConsignor" [(ngModel)]="selectedConsignorId" class="form-control">
              <option value="">Select consignor...</option>
              @for (consignor of consignors(); track consignor.id) {
                <option [value]="consignor.id">{{ consignor.name }} ({{ consignor.consignorNumber }})</option>
              }
            </select>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="markAsVerified" class="checkbox-input">
              <span>Mark as Verified</span>
            </label>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="assignAnother" class="checkbox-input">
              <span>Assign another consignor</span>
            </label>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" (click)="closeBulkAssignModal()">Cancel</button>
          <button
            class="btn-primary"
            [disabled]="!selectedConsignorId() || isLoading()"
            (click)="bulkAssignConsignor()">
            {{ isLoading() ? 'Assigning...' : 'Assign' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Remove from Inventory Modal -->
    <div class="modal-overlay" *ngIf="isRemovalModalOpen()" (click)="closeRemovalModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>üì§ Remove from Inventory</h2>
          <button class="close-btn" (click)="closeRemovalModal()">√ó</button>
        </div>
        <div class="modal-body">
          <div class="item-summary">
            <h4>{{ selectedItemForRemoval()?.title }}</h4>
            <p class="cell-secondary">SKU: {{ selectedItemForRemoval()?.sku }}</p>
            <p class="cell-secondary">Consignor: {{ selectedItemForRemoval()?.consignorName }}</p>
          </div>

          <div class="form-group">
            <label for="removalReason">Reason for Removal <span class="required">*</span></label>
            <select id="removalReason" [(ngModel)]="selectedRemovalReason" class="form-control">
              <option value="">Select a reason...</option>
              <option value="return-to-consignor">Return to Consignor</option>
              <option value="shop-inventory">Keep in Shop Inventory</option>
              <option value="damaged">Damaged</option>
              <option value="expired">Expired/End of Term</option>
              <option value="lost">Lost/Missing</option>
              <option value="customer-return">Customer Return</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="removalNotes">Additional Notes</label>
            <textarea
              id="removalNotes"
              [(ngModel)]="removalNotes"
              class="form-control"
              rows="3"
              placeholder="Optional notes..."></textarea>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="notifyConsignor" class="checkbox-input">
              <span>Notify consignor about removal</span>
            </label>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" (click)="closeRemovalModal()">Cancel</button>
          <button
            class="btn-danger"
            [disabled]="!selectedRemovalReason || isProcessingRemoval()"
            (click)="confirmRemoval()">
            {{ isProcessingRemoval() ? 'Removing...' : 'Remove from Inventory' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Bulk Import Modal -->
    <div class="modal-overlay" *ngIf="isBulkImportModalOpen()" (click)="closeBulkImport()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>üì¶ Bulk Import Items</h2>
          <button class="close-btn" (click)="closeBulkImport()">√ó</button>
        </div>
        <div class="modal-body">
          <div class="upload-zone"
               (dragover)="onDragOver($event)"
               (dragleave)="onDragLeave($event)"
               (drop)="onDrop($event)"
               [class.drag-active]="isDragActive()">
            <div class="upload-icon">üìÑ</div>
            <div class="upload-title">Import Items from CSV</div>
            <div class="upload-description">
              Drag and drop a CSV file here or click to browse.<br>
              Items will be created as pending imports for review.
            </div>
            <input type="file" #fileInput accept=".csv" style="display: none;" (change)="onFileSelected($event)" />
            <button class="btn-primary" (click)="fileInput.click()">Choose CSV File</button>
          </div>
        </div>
      </div>
    </div>

</div>
