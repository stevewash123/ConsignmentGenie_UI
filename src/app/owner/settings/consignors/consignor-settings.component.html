
    <div class="consignor-settings">
      <div class="settings-header">
        <h2>Consignor Settings</h2>
        <p>Manage how new consignors join your shop and configure approval settings</p>
      </div>

      <div class="settings-form" *ngIf="settings()">
        <!-- Store Code -->
        <div class="form-section">
          <h3>Store Code</h3>
          <p class="section-description">
            Share this code with consignors to let them join your shop.
          </p>

          <div class="store-code-display">
            <div class="code-box">
              <span class="store-code">{{ settings()?.storeCode }}</span>
            </div>
            <div class="code-actions">
              <button class="btn-secondary" (click)="copyStoreCode()">Copy Code</button>
              <button class="btn-secondary" (click)="regenerateStoreCode()">Regenerate</button>
            </div>
          </div>

          <div class="signup-link">
            <label>Direct signup link:</label>
            <div class="link-display">
              <span class="signup-url">{{ settings()?.signupUrl }}</span>
              <button class="btn-link" (click)="copySignupLink()">Copy Link</button>
            </div>
          </div>
        </div>

        <!-- Consignor Approval -->
        <div class="form-section">
          <h3>Consignor Approval</h3>

          <div class="approval-options">
            <label class="radio-option" [class.selected]="settings()?.autoApprove">
              <input
                type="radio"
                [value]="true"
                [(ngModel)]="settings()!.autoApprove"
                name="approvalType">
              <div class="option-content">
                <span class="option-title">Auto-approve new consignors</span>
                <span class="option-description">New consignors can immediately start adding items</span>
              </div>
            </label>

            <label class="radio-option" [class.selected]="!settings()?.autoApprove">
              <input
                type="radio"
                [value]="false"
                [(ngModel)]="settings()!.autoApprove"
                name="approvalType">
              <div class="option-content">
                <span class="option-title">Require manual approval</span>
                <span class="option-description">Review each consignor before they can add items</span>
              </div>
            </label>
          </div>
        </div>

        <!-- Inventory Permissions -->
        <div class="form-section">
          <h3>Consignor Inventory Permissions</h3>
          <p class="section-description">
            Control what actions consignors can perform with their inventory items.
          </p>

          <div class="permissions-grid">
            <div class="permission-item">
              <label class="permission-toggle">
                <input
                  type="checkbox"
                  [(ngModel)]="settings()!.inventoryPermissions.canAddItems"
                  name="canAddItems">
                <div class="toggle-switch"></div>
                <div class="permission-content">
                  <span class="permission-title">Add new items</span>
                  <span class="permission-description">Allow consignors to submit new items for approval</span>
                </div>
              </label>
            </div>

            <div class="permission-item">
              <label class="permission-toggle">
                <input
                  type="checkbox"
                  [(ngModel)]="settings()!.inventoryPermissions.canEditItems"
                  name="canEditItems">
                <div class="toggle-switch"></div>
                <div class="permission-content">
                  <span class="permission-title">Edit existing items</span>
                  <span class="permission-description">Allow consignors to modify details of their approved items</span>
                </div>
              </label>
            </div>

            <div class="permission-item">
              <label class="permission-toggle">
                <input
                  type="checkbox"
                  [(ngModel)]="settings()!.inventoryPermissions.canRemoveItems"
                  name="canRemoveItems">
                <div class="toggle-switch"></div>
                <div class="permission-content">
                  <span class="permission-title">Remove/withdraw items</span>
                  <span class="permission-description">Allow consignors to withdraw items from the shop</span>
                </div>
              </label>
            </div>

            <div class="permission-item">
              <label class="permission-toggle">
                <input
                  type="checkbox"
                  [(ngModel)]="settings()!.inventoryPermissions.canViewDetailedAnalytics"
                  name="canViewDetailedAnalytics">
                <div class="toggle-switch"></div>
                <div class="permission-content">
                  <span class="permission-title">View detailed analytics</span>
                  <span class="permission-description">Allow consignors to see detailed sales metrics and performance data</span>
                </div>
              </label>
            </div>
          </div>

          <div class="permissions-note">
            <div class="note-icon">ðŸ’¡</div>
            <div class="note-content">
              <strong>Note:</strong> Consignors can always view their basic inventory list and sale notifications.
              These permissions control additional actions and data access.
            </div>
          </div>
        </div>

        <!-- Invite Consignors -->
        <div class="form-section">
          <h3>Invite Consignors</h3>

          <div class="invite-form">
            <div class="form-group">
              <label for="inviteEmails">Email addresses (one per line)</label>
              <textarea
                id="inviteEmails"
                [(ngModel)]="inviteEmailsText"
                name="inviteEmails"
                class="form-textarea invite-emails"
                placeholder="jane@example.com&#10;bob@example.com"
                rows="4"></textarea>
            </div>

            <div class="form-group">
              <label for="inviteMessage">Custom message (optional)</label>
              <textarea
                id="inviteMessage"
                [(ngModel)]="customMessage"
                name="inviteMessage"
                class="form-textarea"
                placeholder="Join our consignment family! We'd love to have your items in our shop..."
                rows="3"></textarea>
            </div>

            <div class="invite-actions">
              <button
                class="btn-primary"
                (click)="sendInvitations()"
                [disabled]="isSending() || !inviteEmailsText.trim()">
                {{ isSending() ? 'Sending...' : 'Send Invitations' }}
              </button>
            </div>
          </div>
        </div>

        <!-- Pending Invitations -->
        <div class="form-section" *ngIf="pendingInvitations().length > 0">
          <h3>Pending Invitations</h3>

          <div class="invitations-list">
            <div
              *ngFor="let invitation of pendingInvitations()"
              class="invitation-item"
              [class]="'status-' + invitation.status">
              <div class="invitation-info">
                <div class="invitation-email">{{ invitation.email }}</div>
                <div class="invitation-details">
                  <span>Sent {{ invitation.sentAt | date:'MMM d' }}</span>
                  <span class="separator">â€¢</span>
                  <span class="status" [class]="'status-' + invitation.status">
                    {{ getInvitationStatusText(invitation) }}
                  </span>
                </div>
              </div>
              <div class="invitation-actions">
                <button
                  *ngIf="invitation.status === 'pending'"
                  class="btn-secondary btn-small"
                  (click)="resendInvitation(invitation.id)">
                  Resend
                </button>
                <button
                  class="btn-danger-outline btn-small"
                  (click)="cancelInvitation(invitation.id)">
                  {{ invitation.status === 'pending' ? 'Cancel' : 'Remove' }}
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Agreement Template -->
        <div class="form-section">
          <h3>Agreement Template</h3>
          <p class="section-description">
            Download a professional consignment agreement template that you can print and use with consignors.
          </p>

          <div class="agreement-template">
            <div class="template-info">
              <h4>Consignment Agreement Template</h4>
              <p>A professional, print-ready PDF template with standard consignment terms, signature lines, and fillable blanks for shop and consignor details.</p>
              <ul class="template-features">
                <li>âœ“ Standard consignment terms and conditions</li>
                <li>âœ“ Fillable fields for shop and consignor information</li>
                <li>âœ“ Commission split and consignment period fields</li>
                <li>âœ“ Signature lines for both parties</li>
                <li>âœ“ Print-friendly letter size format</li>
              </ul>
            </div>
            <div class="template-actions">
              <button class="btn-primary" (click)="downloadTemplate()">
                <span class="download-icon">ðŸ“„</span>
                Download PDF Template
              </button>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="form-actions">
          <button type="button" class="btn-secondary" (click)="loadSettings()">Cancel</button>
          <button type="button" class="btn-primary" (click)="saveSettings()" [disabled]="isSaving()">
            {{ isSaving() ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>
      </div>

      <!-- Messages -->
      <div class="messages" *ngIf="successMessage() || errorMessage()">
        <div *ngIf="successMessage()" class="message success">{{ successMessage() }}</div>
        <div *ngIf="errorMessage()" class="message error">{{ errorMessage() }}</div>
      </div>
    </div>
  