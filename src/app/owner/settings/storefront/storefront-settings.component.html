<div class="storefront-settings">
  <header class="section-header">
    <h2 class="section-title">Online Storefront Settings</h2>
    <p class="section-description">Configure how customers shop online</p>
  </header>

  <div *ngIf="successMessage()" class="message success">{{ successMessage() }}</div>
  <div *ngIf="errorMessage()" class="message error">{{ errorMessage() }}</div>

  <div *ngIf="storefrontSettings()">
    <!-- Basic Storefront Settings -->
    <section class="form-section">
      <h3>Store Information</h3>

      <div class="form-group">
        <label for="storeSlug">Store Slug</label>
        <input
          id="storeSlug"
          type="text"
          class="form-input"
          [value]="getStoreSlug()"
          (input)="onStoreSlugChange($any($event.target).value)"
          placeholder="my-store">
        <div class="field-help">Your store URL: consignmentgenie.com/shop/{{ getStoreSlug() || 'your-slug' }}</div>
      </div>

      <div class="form-group">
        <label for="bannerImage">Banner Image URL</label>
        <input
          id="bannerImage"
          type="url"
          class="form-input"
          [value]="getBannerImageUrl()"
          (input)="onBannerImageUrlChange($any($event.target).value)"
          placeholder="https://example.com/banner.jpg">
      </div>
    </section>

    <!-- Payment Settings -->
    <section class="form-section">
      <h3>Payment Settings</h3>

      <div class="checkbox-group">
        <label class="checkbox-label">
          <input
            type="checkbox"
            [checked]="getEnableCreditCards()"
            (change)="onEnableCreditCardsChange($any($event.target).checked)">
          <span class="checkmark"></span>
          Enable Credit Cards with Stripe
        </label>

        <label class="checkbox-label">
          <input
            type="checkbox"
            [checked]="getEnableBuyNow()"
            (change)="onEnableBuyNowChange($any($event.target).checked)">
          <span class="checkmark"></span>
          Enable Buy Now
        </label>

        <label class="checkbox-label">
          <input
            type="checkbox"
            [checked]="getEnableLayaway()"
            (change)="onEnableLayawayChange($any($event.target).checked)">
          <span class="checkmark"></span>
          Enable Layaway
        </label>
      </div>

      <div class="form-row" *ngIf="getEnableLayaway()">
        <div class="form-group">
          <label for="layawayDeposit">Layaway Deposit Percentage</label>
          <input
            id="layawayDeposit"
            type="number"
            min="0"
            max="100"
            class="form-input"
            [value]="getLayawayDepositPercentage()"
            (input)="onLayawayDepositPercentageChange(+$any($event.target).value)">
        </div>

        <div class="form-group">
          <label for="layawayTerms">Layaway Terms (Days)</label>
          <input
            id="layawayTerms"
            type="number"
            min="1"
            class="form-input"
            [value]="getLayawayTermsInDays()"
            (input)="onLayawayTermsInDaysChange(+$any($event.target).value)">
        </div>
      </div>

      <!-- Stripe Configuration (shows as disabled when credit cards are off) -->
      <div class="stripe-configuration" [class.disabled]="!getEnableCreditCards()">
        <div class="stripe-config-header">
          <div class="stripe-description">
            <p>Configure Stripe payment processing for credit card transactions.</p>
          </div>
          <div class="stripe-status">
            <span class="status-badge" [class]="getStripeConnected() ? 'connected' : 'disconnected'">
              {{ getStripeConnected() ? 'Connected' : 'Not Connected' }}
            </span>
          </div>
        </div>

        <div class="stripe-actions">
          <div class="form-actions" *ngIf="!getStripeConnected()">
            <button type="button" class="btn btn-primary"
                    [disabled]="!getEnableCreditCards()"
                    (click)="connectToStripe()">
              Connect to Stripe
            </button>
          </div>

          <div class="form-actions" *ngIf="getStripeConnected()">
            <button type="button" class="btn btn-secondary"
                    [disabled]="!getEnableCreditCards()"
                    (click)="disconnectFromStripe()">
              Disconnect Stripe
            </button>
            <button type="button" class="btn btn-primary"
                    [disabled]="!getEnableCreditCards()"
                    (click)="configureStripe()">
              Configure Stripe Settings
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Shipping Settings -->
    <section class="form-section">
      <h3>Shipping Settings</h3>

      <div class="checkbox-group">
        <label class="checkbox-label">
          <input
            type="checkbox"
            [checked]="getEnableShipping()"
            (change)="onEnableShippingChange($any($event.target).checked)">
          <span class="checkmark"></span>
          Enable Shipping
        </label>
      </div>

      <div class="form-row" *ngIf="getEnableShipping()">
        <div class="form-group">
          <label for="flatRate">Flat Shipping Rate ($)</label>
          <input
            id="flatRate"
            type="number"
            min="0"
            step="0.01"
            class="form-input"
            [value]="getFlatRate()"
            (input)="onFlatRateChange(+$any($event.target).value)">
        </div>

        <div class="form-group">
          <label for="freeShippingThreshold">Free Shipping Threshold ($)</label>
          <input
            id="freeShippingThreshold"
            type="number"
            min="0"
            step="0.01"
            class="form-input"
            [value]="getFreeShippingThreshold()"
            (input)="onFreeShippingThresholdChange(+$any($event.target).value)">
        </div>

        <div class="form-group">
          <label for="shipsFromZip">Ships From ZIP Code</label>
          <input
            id="shipsFromZip"
            type="text"
            class="form-input"
            [value]="getShipsFromZipCode()"
            (input)="onShipsFromZipCodeChange($any($event.target).value)"
            placeholder="12345">
        </div>
      </div>
    </section>

    <!-- Sales Settings -->
    <section class="form-section">
      <h3>Sales Settings</h3>

      <div class="checkbox-group">
        <label class="checkbox-label">
          <input
            type="checkbox"
            [checked]="getEnableBestOffer()"
            (change)="onEnableBestOfferChange($any($event.target).checked)">
          <span class="checkmark"></span>
          Enable Best Offer
        </label>
      </div>

      <div class="form-row" *ngIf="getEnableBestOffer()">
        <div class="form-group">
          <label for="autoAccept">Auto Accept Percentage (%)</label>
          <input
            id="autoAccept"
            type="number"
            min="0"
            max="100"
            class="form-input"
            [value]="getAutoAcceptPercentage()"
            (input)="onAutoAcceptPercentageChange(+$any($event.target).value)">
          <div class="field-help">Automatically accept offers above this percentage of asking price</div>
        </div>

        <div class="form-group">
          <label for="minimumOffer">Minimum Offer Percentage (%)</label>
          <input
            id="minimumOffer"
            type="number"
            min="0"
            max="100"
            class="form-input"
            [value]="getMinimumOfferPercentage()"
            (input)="onMinimumOfferPercentageChange(+$any($event.target).value)">
          <div class="field-help">Lowest offer percentage customers can submit</div>
        </div>
      </div>
    </section>
  </div>

  <!-- Loading state -->
  <div *ngIf="!storefrontSettings()" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading storefront settings...</p>
  </div>
</div>