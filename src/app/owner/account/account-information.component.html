<div class="account-info-page">
  <header class="page-header">
    <h1>Account Information</h1>
    <p>View your organization details, subscription plan, and usage statistics</p>
  </header>

  <div *ngIf="isLoading()" class="loading-state">
    <p>Loading account information...</p>
  </div>

  <div *ngIf="accountInfo()" class="account-content">
    <!-- Organization Details -->
    <section class="info-section">
      <h2>Organization</h2>

      <div class="info-grid">
        <div class="info-item">
          <label>Organization Name</label>
          <div class="info-value">{{ accountInfo()!.organization.name }}</div>
        </div>

        <div class="info-item">
          <label>Business Type</label>
          <div class="info-value">{{ getBusinessTypeLabel(accountInfo()!.organization.type) }}</div>
        </div>

        <div class="info-item">
          <label>Account Created</label>
          <div class="info-value">{{ accountInfo()!.organization.createdDate | date:'mediumDate' }}</div>
        </div>

        <div class="info-item">
          <label>Last Login</label>
          <div class="info-value">{{ accountInfo()!.organization.lastLoginDate | date:'short' }}</div>
        </div>

        <div class="info-item">
          <label>Primary Contact</label>
          <div class="info-value">
            {{ accountInfo()!.organization.primaryContact.name }}<br>
            <span class="text-secondary">{{ accountInfo()!.organization.primaryContact.email }}</span>
            <span *ngIf="accountInfo()!.organization.primaryContact.phone" class="text-secondary"><br>{{ accountInfo()!.organization.primaryContact.phone }}</span>
          </div>
        </div>

        <div class="info-item">
          <label>Total Locations</label>
          <div class="info-value">{{ accountInfo()!.organization.totalLocations }}</div>
        </div>
      </div>
    </section>

    <!-- Current Plan -->
    <section class="info-section">
      <h2>Current Subscription</h2>

      <div class="plan-overview">
        <div class="plan-info">
          <h3>{{ accountInfo()!.currentPlan.name }}</h3>
          <div class="plan-price">
            ${{ getTotalMonthlyPrice() }}
            <span class="billing-cycle">/ {{ accountInfo()!.currentPlan.billingCycle }}</span>
          </div>
          <div class="pricing-breakdown">
            <div class="breakdown-line">
              Base Platform: ${{ accountInfo()!.currentPlan.basePrice }}
            </div>
            <div class="breakdown-line" *ngIf="accountInfo()!.currentPlan.activeIntegrations.length > 0">
              {{ accountInfo()!.currentPlan.activeIntegrations.length }} Integration(s): ${{ accountInfo()!.currentPlan.activeIntegrations.length * accountInfo()!.currentPlan.integrationPrice }}
            </div>
            <div class="founder-badge" *ngIf="accountInfo()!.currentPlan.isFounder">
              ðŸŽ‰ Founder {{ accountInfo()!.currentPlan.founderTier }} Pricing (Locked Forever)
            </div>
          </div>
          <div class="next-billing">
            Next billing: {{ accountInfo()!.nextBillingDate | date:'mediumDate' }}
          </div>
        </div>

        <div class="plan-features">
          <h4>Plan Features</h4>
          <ul class="features-list">
            <li *ngFor="let feature of accountInfo()!.currentPlan.features">
              <span class="feature-check">âœ“</span>
              {{ feature }}
            </li>
          </ul>
        </div>
      </div>

      <div class="active-integrations">
        <h4>Active Integrations</h4>
        <div class="integrations-list">
          <div class="integration-item" *ngFor="let integration of accountInfo()!.currentPlan.activeIntegrations">
            <div class="integration-info">
              <h5>{{ integration.name }}</h5>
              <span class="integration-type">{{ integration.type | titlecase }}</span>
            </div>
            <div class="integration-status">
              <span class="status-badge active">Active</span>
              <span class="activated-date" *ngIf="integration.activatedDate">
                Since {{ integration.activatedDate | date:'MMM yyyy' }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Usage Statistics -->
    <section class="info-section">
      <h2>Current Usage</h2>

      <div class="usage-grid">
        <div class="usage-item" *ngFor="let type of getUsageTypes()">
          <div class="usage-header">
            <span class="usage-label">{{ type.label }}</span>
            <span class="usage-numbers">
              {{ accountInfo()!.usage[type.key].current }}
              <span *ngIf="accountInfo()!.usage[type.key].limit"> / {{ accountInfo()!.usage[type.key].limit }}</span>
              <span *ngIf="!accountInfo()!.usage[type.key].limit"> / Unlimited</span>
            </span>
          </div>
          <div class="usage-bar" *ngIf="accountInfo()!.usage[type.key].limit">
            <div class="usage-progress" [style.width.%]="getUsagePercentage(type.key)"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Billing History -->
    <section class="info-section">
      <h2>Billing History</h2>

      <div class="billing-table">
        <div class="table-header">
          <div>Date</div>
          <div>Description</div>
          <div>Amount</div>
          <div>Status</div>
          <div>Actions</div>
        </div>
        <div class="table-row" *ngFor="let invoice of accountInfo()!.billingHistory">
          <div class="billing-date">{{ invoice.date | date:'mediumDate' }}</div>
          <div class="billing-description">{{ invoice.description }}</div>
          <div class="billing-amount">${{ invoice.amount }}</div>
          <div class="billing-status status-{{ invoice.status }}">{{ invoice.status | titlecase }}</div>
          <div>
            <button *ngIf="invoice.downloadUrl" (click)="downloadInvoice(invoice.id)" class="btn-link">
              Download
            </button>
          </div>
        </div>
      </div>

      <div class="billing-portal-link">
        <p>Need to update payment methods or view more detailed billing information?</p>
        <button class="btn-link" (click)="openBillingPortal()">
          Open Billing Portal
        </button>
      </div>
    </section>
  </div>
</div>