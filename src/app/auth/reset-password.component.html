<div class="reset-password-page">
  <div class="container">
    <div class="reset-password-card">
      <div class="header">
        <h1>Reset Your Password</h1>
      </div>

      <!-- Loading state -->
      <div *ngIf="isValidating()" class="loading-state">
        <div class="spinner"></div>
        <p>Validating reset link...</p>
      </div>

      <!-- Invalid token -->
      <div *ngIf="!isValidating() && !tokenValid()" class="error-state">
        <div class="error-icon">⚠️</div>
        <h2>Invalid Reset Link</h2>
        <p class="error-description">{{ errorMessage() }}</p>
        <div class="action-buttons">
          <button type="button" class="primary-btn" (click)="requestNewReset()">
            Request New Reset
          </button>
          <button type="button" class="secondary-btn" (click)="goToLogin()">
            Back to Login
          </button>
        </div>
      </div>

      <!-- Reset form -->
      <div *ngIf="!isValidating() && tokenValid() && !successMessage()" class="reset-form">
        <p class="subtitle">Enter your new password below.</p>

        <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <label for="newPassword">New Password *</label>
            <input
              id="newPassword"
              type="password"
              formControlName="newPassword"
              [class.error]="resetPasswordForm.get('newPassword')?.invalid && resetPasswordForm.get('newPassword')?.touched"
              placeholder="••••••••••••">
            <div class="form-hint">At least 8 characters</div>
            <div class="error-message"
                 *ngIf="resetPasswordForm.get('newPassword')?.invalid && resetPasswordForm.get('newPassword')?.touched">
              Password must be at least 8 characters
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">Confirm New Password *</label>
            <input
              id="confirmPassword"
              type="password"
              formControlName="confirmPassword"
              [class.error]="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched"
              placeholder="••••••••••••">
            <div class="error-message"
                 *ngIf="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched">
              Passwords must match
            </div>
          </div>

          <button
            type="submit"
            class="submit-btn"
            [disabled]="resetPasswordForm.invalid || isSubmitting()">
            {{ isSubmitting() ? 'Resetting...' : 'Reset Password' }}
          </button>
        </form>
      </div>

      <!-- Success state -->
      <div *ngIf="successMessage()" class="success-state">
        <div class="success-icon">✅</div>
        <h2>Password Reset Successfully</h2>
        <p class="success-message">{{ successMessage() }}</p>
        <p class="redirect-message">You will be redirected to the login page in 3 seconds...</p>
        <button type="button" class="primary-btn" (click)="goToLogin()">
          Go to Login Now
        </button>
      </div>

      <!-- Error Display -->
      <div class="alert error" *ngIf="errorMessage() && tokenValid()">
        {{ errorMessage() }}
      </div>
    </div>
  </div>
</div>