<div class="modal-overlay" *ngIf="show" (click)="onBackdropClick($event)">
  <div class="modal-container">
    <!-- Header -->
    <div class="modal-header">
      <h2 class="modal-title">Request Payout</h2>
      <button class="close-button" (click)="onClose()" [disabled]="isSubmitting">
        ×
      </button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <p class="intro-text">
        You're requesting a payout of your available balance:
      </p>

      <!-- Balance Summary -->
      <div class="balance-summary" *ngIf="balance">
        <div class="balance-row">
          <span class="balance-label">Available Balance:</span>
          <span class="balance-value balance-amount">${{ balance.available.amount.toFixed(2) }}</span>
        </div>
        <div class="balance-row">
          <span class="balance-label">Items Included:</span>
          <span class="balance-value">{{ balance.available.itemCount }} items</span>
        </div>
      </div>

      <div class="divider"></div>

      <!-- Note Field -->
      <div class="form-group">
        <label class="form-label" for="payout-note">
          Note to shop (optional):
        </label>
        <textarea
          id="payout-note"
          class="form-textarea"
          [(ngModel)]="note"
          placeholder="Can you mail the check to my new address?"
          maxlength="500"
          [disabled]="isSubmitting">
        </textarea>
      </div>

      <div class="divider"></div>

      <!-- Info Section -->
      <div class="info-section">
        <p class="info-text">
          <span class="info-icon">ⓘ</span>
          <strong>The shop will be notified of your request.</strong><br>
          Typical processing time: 1-3 business days.
        </p>
      </div>

      <!-- Error Message -->
      <div class="error-message" *ngIf="error">
        <p>{{ error }}</p>
      </div>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button
        class="button button-secondary"
        (click)="onClose()"
        [disabled]="isSubmitting">
        Cancel
      </button>
      <button
        class="button button-primary"
        (click)="onSubmit()"
        [disabled]="!canSubmit">
        <span class="loading-spinner" *ngIf="isSubmitting"></span>
        {{ isSubmitting ? 'Submitting...' : 'Submit Request' }}
      </button>
    </div>
  </div>
</div>