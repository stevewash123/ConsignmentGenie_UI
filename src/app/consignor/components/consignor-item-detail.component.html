
    <div class="item-detail">
      <!-- Navigation Header -->
      <div class="nav-header">
        <div class="header-content">
          <h1>Main Street Consignment</h1>
          <nav class="nav-links">
            <a routerLink="/consignor/dashboard" routerLinkActive="active">Dashboard</a>
            <a routerLink="/consignor/items" routerLinkActive="active">Items</a>
            <a routerLink="/consignor/sales" routerLinkActive="active">Sales</a>
            <a routerLink="/consignor/payouts" routerLinkActive="active">Payouts</a>
          </nav>
        </div>
      </div>

      <div class="content" *ngIf="item">
        <!-- Back Button -->
        <div class="back-section">
          <a routerLink="/consignor/items" class="back-btn">‚Üê Back to My Items</a>
        </div>

        <!-- Item Header -->
        <div class="item-header">
          <h2>{{item.title}}</h2>
          <div class="item-sku">SKU: {{item.sku}}</div>
        </div>

        <!-- Item Content Grid -->
        <div class="item-content">
          <!-- Images Section -->
          <div class="images-section">
            <div class="primary-image">
              <img
                *ngIf="item.primaryImageUrl"
                [src]="item.primaryImageUrl"
                [alt]="item.title"
                loading="lazy">
              <div *ngIf="!item.primaryImageUrl" class="image-placeholder">
                <span>üì∑</span>
                <p>No image available</p>
              </div>
            </div>

            <!-- Additional Images -->
            <div class="thumbnail-grid" *ngIf="item.imageUrls.length > 1">
              <div
                class="thumbnail"
                *ngFor="let imageUrl of item.imageUrls"
                (click)="selectImage(imageUrl)">
                <img [src]="imageUrl" [alt]="item.title">
              </div>
            </div>
          </div>

          <!-- Item Details Section -->
          <div class="details-section">
            <!-- Status Badge -->
            <div class="status-section">
              <span class="status-badge" [class]="getStatusClass(item.status)">
                {{getStatusDisplay(item.status)}}
              </span>
            </div>

            <!-- Pending Price Request Alert -->
            <div class="pending-request-alert" *ngIf="mockItem?.pendingPriceRequest">
              <div class="alert-icon">‚è≥</div>
              <div class="alert-content">
                <h4>Price Change Request Pending</h4>
                <p>
                  You requested: ${{mockItem.pendingPriceRequest.currentPrice.toFixed(2)}} ‚Üí
                  ${{mockItem.pendingPriceRequest.requestedPrice.toFixed(2)}}
                </p>
                <p class="alert-date">
                  Submitted: {{formatPendingRequestDate(mockItem.pendingPriceRequest.requestDate)}}
                </p>
                <p class="alert-message">
                  The shop owner will review your request soon.
                </p>
              </div>
            </div>

            <!-- Pending Return Request Alert -->
            <div class="pending-request-alert" *ngIf="mockItem?.pendingReturnRequest && mockItem.pendingReturnRequest.status === 'pending'">
              <div class="alert-icon">üì¶</div>
              <div class="alert-content">
                <h4>Return Request Pending</h4>
                <p class="alert-date">
                  Submitted: {{formatPendingRequestDate(mockItem.pendingReturnRequest.submittedDate)}}
                </p>
                <p class="alert-message">
                  Status: Waiting for shop to prepare item
                </p>
                <p class="alert-message">
                  You'll be notified when your item is ready for pickup.
                </p>
              </div>
            </div>

            <!-- Ready for Pickup Alert -->
            <div class="ready-return-alert" *ngIf="mockItem?.pendingReturnRequest && mockItem.pendingReturnRequest.status === 'ready'">
              <div class="alert-icon">‚úÖ</div>
              <div class="alert-content">
                <h4>Ready for Pickup!</h4>
                <p>Your item is ready to be picked up.</p>
                <div *ngIf="mockItem.pendingReturnRequest.pickupInstructions">
                  <p><strong>Pickup Instructions:</strong></p>
                  <p class="alert-message">{{mockItem.pendingReturnRequest.pickupInstructions}}</p>
                </div>
              </div>
            </div>

            <!-- Pricing Information -->
            <div class="pricing-section">
              <div class="price-row">
                <span class="price-label">Item Price:</span>
                <span class="price-value">\${{item.price.toFixed(2)}}</span>
              </div>
              <div class="price-row earnings">
                <span class="price-label">Your Earnings:</span>
                <span class="price-value">\${{item.myEarnings.toFixed(2)}}</span>
              </div>
              <div class="commission-note">
                Your commission rate applies to this item
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="price-change-actions" *ngIf="mockItem && (item.status.toLowerCase() === 'available' || item.status.toLowerCase() === 'expired')">
              <!-- Price Change Button (Available items only) -->
              <button
                *ngIf="item.status.toLowerCase() === 'available'"
                type="button"
                class="btn-request-price-change"
                (click)="openPriceChangeModal()"
                [disabled]="!canRequestPriceChange()"
                [title]="mockItem.hasPendingPriceRequest ? 'You already have a pending price change request' : 'Request a price change for this item'">
                <span *ngIf="!mockItem.hasPendingPriceRequest">Request Price Change</span>
                <span *ngIf="mockItem.hasPendingPriceRequest">Price Change Pending</span>
              </button>

              <!-- Return Request Button (Available or Expired items) -->
              <button
                type="button"
                class="btn-request-return"
                (click)="openReturnRequestModal()"
                [disabled]="!canRequestReturn()"
                [title]="mockItem.pendingReturnRequest ? 'You already have a pending return request' : 'Request to get your item back'">
                <span *ngIf="!mockItem.pendingReturnRequest">Request Return</span>
                <span *ngIf="mockItem.pendingReturnRequest && mockItem.pendingReturnRequest.status === 'pending'">Return Request Pending</span>
                <span *ngIf="mockItem.pendingReturnRequest && mockItem.pendingReturnRequest.status === 'ready'">Ready for Pickup</span>
              </button>
            </div>

            <!-- Item Information -->
            <div class="info-section">
              <div class="info-row">
                <span class="info-label">Category:</span>
                <span class="info-value">{{item.category}}</span>
              </div>
              <div class="info-row">
                <span class="info-label">Received Date:</span>
                <span class="info-value">{{formatDate(item.receivedDate)}}</span>
              </div>
              <div class="info-row" *ngIf="item.soldDate">
                <span class="info-label">Sold Date:</span>
                <span class="info-value">{{formatDate(item.soldDate)}}</span>
              </div>
              <div class="info-row" *ngIf="item.salePrice">
                <span class="info-label">Sale Price:</span>
                <span class="info-value">\${{item.salePrice.toFixed(2)}}</span>
              </div>
            </div>

            <!-- Description -->
            <div class="description-section" *ngIf="item.description">
              <h3>Description</h3>
              <p class="description-text">{{item.description}}</p>
            </div>

            <!-- Notes -->
            <div class="notes-section" *ngIf="item.notes">
              <h3>Shop Notes</h3>
              <p class="notes-text">{{item.notes}}</p>
            </div>

            <!-- Contact Information -->
            <div class="contact-section">
              <h3>Questions about this item?</h3>
              <p class="contact-text">
                Contact the shop at <a href="tel:+15551234567">(555) 123-4567</a>
                or speak with them during your next visit.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div class="loading" *ngIf="loadingService.isLoading(KEYS.ITEM_DETAIL)">
        <p>Loading item details...</p>
      </div>

      <!-- Error State -->
      <div class="error" *ngIf="error">
        <p>{{error}}</p>
        <button (click)="loadItem()">Retry</button>
      </div>

      <!-- Price Change Request Modal -->
      <app-request-price-change
        *ngIf="mockItem"
        [item]="mockItem"
        [show]="showPriceChangeModal"
        (closed)="onPriceChangeModalClosed($event)">
      </app-request-price-change>

      <!-- Return Request Modal -->
      <app-return-request-modal
        *ngIf="mockItem"
        [item]="mockItem"
        [isVisible]="showReturnRequestModal"
        (closed)="onReturnRequestModalClosed($event)">
      </app-return-request-modal>
    </div>
